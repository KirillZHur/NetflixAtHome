x-env:
  &default-env
  env_file:
    - .env

services:

  nx_metrics:
    build: nx_metrics/
    container_name: nx_metrics
    <<: *default-env
    ports:
      - "8900:5000"
    environment:
      PYTHONUNBUFFERED: 1
    healthcheck:
      test: [ "CMD", "curl", "--fail", "http://localhost:5000/ping" ]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: always